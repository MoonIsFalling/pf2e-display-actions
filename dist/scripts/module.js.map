{"version":3,"file":"module.js","sources":["../../src/ts/constants.ts","../../src/ts/apps/displayActions.ts","../../src/ts/module.ts"],"sourcesContent":["import {name} from '../module.json';\n\nexport const moduleId = name;\nexport const moduleName = 'DisplayActions2e';\n","import {moduleId} from '../constants';\r\n\r\nexport class DisplayActions2e extends Application {\r\n  private clickString = 'symbolClick';\r\n  private actionImage = `modules/${moduleId}/images/action.png`;\r\n  private reactionImage = `modules/${moduleId}/images/reaction.png`;\r\n  private numOfActions = 3;\r\n  private numOfReactions = 1;\r\n\r\n  constructor() {\r\n    super();\r\n  }\r\n\r\n  override get title(): string {\r\n    return (game as Game).i18n.localize('DisplayActions2e.WindowTitle');\r\n  }\r\n\r\n  static override get defaultOptions(): ApplicationOptions {\r\n    return foundry.utils.mergeObject(super.defaultOptions, {\r\n      id: 'DisplayActions2e',\r\n      template: `modules/${moduleId}/templates/result.hbs`,\r\n      width: 600,\r\n      height: 200,\r\n      resizable: true,\r\n      title: 'DisplayActions2e.WindowTitle',\r\n    }) as ApplicationOptions;\r\n  }\r\n\r\n  override getData() {\r\n    return {\r\n      numOfActions: this.numOfActions,\r\n      numOfReactions: this.numOfReactions,\r\n      actionImagePayload: this.buildHandlebarPayload(this.numOfActions, {actionImage: this.actionImage}),\r\n      reactionImagePayload: this.buildHandlebarPayload(this.numOfReactions, {reactionImage: this.reactionImage}),\r\n    };\r\n  }\r\n\r\n  override activateListeners(html: JQuery<HTMLElement>): void {\r\n    super.activateListeners(html);\r\n    html.find('img.symbol').on('click', this._onClickSymbolImage.bind(this));\r\n    html.find('input.input-counter').on('change', this._onChangeCountNumber.bind(this));\r\n  }\r\n\r\n  private _onClickSymbolImage(event: Event) {\r\n    event.preventDefault();\r\n    const image = event.currentTarget as HTMLImageElement;\r\n    if (image === undefined || image === null) {\r\n      return;\r\n    }\r\n    if (image.className === undefined || image.className === null) {\r\n      return;\r\n    }\r\n    if (image.className.includes(this.clickString)) {\r\n      image.className = image.className.replace(this.clickString, '');\r\n    } else {\r\n      image.className = image.className.concat(' ', this.clickString);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Helper function to make Payload for Handlebars each loop to pass data\r\n   * @param iterator array size\r\n   */\r\n  private buildHandlebarPayload(iterator: number, data: any) {\r\n    let payload = [];\r\n    for (let index = 0; index < iterator; index++) {\r\n      payload.push(data);\r\n    }\r\n    return payload;\r\n  }\r\n\r\n  private _onChangeCountNumber(event: Event) {\r\n    event.preventDefault();\r\n    const input = event.currentTarget as HTMLInputElement;\r\n    const value = parseInt(input.value);\r\n    console.log(value);\r\n    if (!isNaN(value)) {\r\n      if (value >= 0) {\r\n        switch (input.id) {\r\n          case 'count-action':\r\n            this.numOfActions = value;\r\n            break;\r\n          case 'count-reaction':\r\n            this.numOfReactions = value;\r\n            break;\r\n          default:\r\n            console.error(`${moduleId} incorrectly handled number of actions!`);\r\n        }\r\n        this.render();\r\n      }\r\n    }\r\n  }\r\n}\r\n","// Do not remove this import. If you do Vite will think your styles are dead\n// code and not include them in the build output.\nimport '../styles/module.css';\nimport {DisplayActions2e} from './apps/displayActions';\nimport {moduleId} from './constants';\nimport {MyModule} from './types';\n\nlet module: MyModule;\n\n// Handlebar helper\n// times iterator --> for loop\n\nHandlebars.registerHelper('times', function (n, block) {\n  let accum = '';\n\n  for (let i = 0; i < n; ++i) {\n    accum += block.fn(i);\n  }\n  return accum;\n});\n\nHandlebars.registerHelper('timesImages', function (n, options: Handlebars.HelperOptions) {\n  let accum = '';\n\n  for (let i = 0; i < n; ++i) {\n    accum += options.fn(i, options.data);\n  }\n  return accum;\n});\n\n// Foundry Hooks\nHooks.once('init', () => {\n  console.log(`Initializing ${moduleId}`);\n\n  module = (game as Game).modules.get(moduleId) as MyModule;\n  module.displayActions2e = new DisplayActions2e();\n});\n\nHooks.on('getSceneControlButtons', hudButtons => {\n  let hud = hudButtons.find(value => {\n    return value.name === 'token';\n  });\n\n  hud?.tools.push({\n    name: 'DisplayActions2e.ButtonName',\n    title: 'DisplayActions2e.ButtonHint',\n    icon: 'fa fa-angle-double-right',\n    button: true,\n    onClick: async () => {\n      module.displayActions2e.render(true);\n      (game as Game).socket?.emit('module.DisplayActions2e', {event: 'DisplayActions2e'});\n    },\n  });\n});\n"],"names":["moduleId","name","DisplayActions2e","__publicField","html","event","image","iterator","data","payload","index","input","value","module","n","block","accum","i","options","hudButtons","hud","_a"],"mappings":"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"}